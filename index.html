<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Noughts & Crosses â€” 3-Piece Cycle</title>
<style>
  :root{
    --grid-line:#222;
    --bg:#0f0f12;
    --panel:#16181d;
    --text:#f3f4f6;
    --muted:#9aa3af;
    --accent:#5eead4;
    --x-color:#e11d48;
    --o-color:#2563eb;
    --cell-size:clamp(60px, 22vmin, 140px);
    --gap:clamp(6px, 1.5vmin, 12px);
    --radius:14px;
    --shadow:0 6px 20px rgba(0,0,0,.35);
  }
  /* color swatches UI */
  .color-label { display:flex; flex-direction:column; gap:8px; font-size:14px; color:var(--muted); }
  .swatches { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
  .swatch {
    width:28px; height:28px; border-radius:50%;
    border:2px solid transparent;
    box-shadow: 0 2px 6px rgba(0,0,0,0.45);
    cursor:pointer;
    transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    display:inline-flex; align-items:center; justify-content:center;
  }
  .swatch:focus { outline:none; transform:translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.5); }
  .swatch.selected { border-color: rgba(255,255,255,0.85); transform: translateY(-2px); }
  .swatch[aria-pressed="true"] { border-color: rgba(255,255,255,0.85); }
  .swatch.small { width:22px; height:22px; } /* optional smaller swatches */
.color-dropdown {
  padding: 6px 8px;
  border-radius: var(--radius, 6px);
  border: 1px solid #444;
  background-color: #111827;
  color: #fff;
  font-size: 14px;
  appearance: none; /* remove default arrow for styling if desired */
}

.color-dropdown option {
  padding: 4px 8px;
  color: inherit;
}

/* Optional: add a small arrow for dropdown */
.color-label {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
  html,body{height:100%;margin:0;background:#0b0c10;color:var(--text);font-family:sans-serif;}
  .app{min-height:100%;display:grid;grid-template-rows:auto 1fr auto;gap:16px;padding:clamp(12px,2.5vmin,24px);}
  header{display:flex;flex-wrap:wrap;align-items:center;gap:12px;justify-content:space-between;}
  header h1{font-size:clamp(18px,2.6vmin,28px);margin:0;}
  .board-container{display: flex;justify-content: center;align-items:center;height:calc(100vh-20px);padding:20px;box-sizing: border-box;}
  .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;background:var(--panel);padding:10px 12px;border-radius:12px;}
  .controls label{font-size:14px;color:var(--muted);}
  select,button{appearance:none;background:#121722;color:var(--text);border:1px solid #2a2f3d;border-radius:10px;padding:8px 10px;font-size:14px;outline:none;}
  button.primary{background:linear-gradient(180deg,#10b981,#0ea5e9);border:none;font-weight:600;}
  .status{font-weight:600;padding:6px 10px;border-radius:10px;background:#0f131a;}
  .score{margin-left:10px;font-weight:600;}
  #score-controls{display:flex;align-items:center;gap:10px;}
  .icon-btn {background:linear-gradient(180deg,#10b981,#0ea5e9);border:none;padding:4px;cursor:pointer;display:flex;align-items:center;}
  .icon-btn img {width:24px;height:24px;pointer-events:none;}
  .icon-btn:hover img {filter:brightness(1.2); }
  .board{display:grid;grid-template-columns:repeat(3,var(--cell-size));grid-template-rows:repeat(3,var(--cell-size));gap:var(--gap);padding:var(--gap);background:#111827;border-radius:var(--radius);}
  .cell{display:grid;place-items:center;background:#0a0d15;border:1px solid #1c2130;border-radius:10px;cursor:pointer;transition:transform .2s ease, opacity .5s ease;font-size:clamp(28px,8vmin,60px);font-weight:900;line-height:1;outline:none;}
  .cell.X{color:var(--x-color);}
  .cell.O{color:var(--o-color);}
  .cell.remove-next{transform:scale(0.75);}
  .cell.fade-out{opacity:0;}
  .win{animation:blink .22s steps(2) 0s 8;}
  @keyframes blink{50%{filter:brightness(2);}}
</style>
</head>
<body>
<div class="app">
  <header>
    <h1>Noughts & Crosses</h1>
    <div class="controls">
    <!-- X / Red dropdown -->
    <label class="color-label">X Colour
      <select id="xColor" class="color-dropdown">
        <option value="#F43F5E" style="background:#F43F5E;color:#fff">Rose</option>
        <option value="#EF4444" style="background:#EF4444;color:#fff">Tomato</option>
        <option value="#F97316" style="background:#F97316;color:#fff">Orange Red</option>
        <option value="#DC2626" style="background:#DC2626;color:#fff">Crimson</option>
        <option value="#F87171" style="background:#F87171;color:#000">Coral</option>
        </select>
      </label>

      <!-- O / Blue dropdown -->
      <label class="color-label">O Colour
        <select id="oColor" class="color-dropdown">
          <option value="#3B82F6" style="background:#3B82F6;color:#fff">Sky Blue</option>
          <option value="#14B8A6" style="background:#14B8A6;color:#fff">Teal</option>
          <option value="#06B6D4" style="background:#06B6D4;color:#000">Cyan</option>
          <option value="#6366F1" style="background:#6366F1;color:#fff">Indigo</option>
          <option value="#60A5FA" style="background:#60A5FA;color:#000">Light Blue</option>
        </select>
      </label>
      <button id="resetBtn" class="primary">Restart</button>
      <div id="status" class="status">Turn: X</div>
      <div id="score-controls">
      <div id="score" class="score">X: 0 â€“ O: 0</div>
      <button id="resetScoreBtn" class="icon-btn" aria-label="Reset Score">
        <img src="https://www.freeiconspng.com/thumbs/restart-icon/black-panel-restart-system-icon--6.png" alt="Undo" />
      </button>
      </div>
  </header>
  <main class="board-container">
  <div id="board" class="board"></div>
</main>
</div>

<script>

(() => {

  const X='X',O='O';

  const winLines=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

  const boardEl=document.getElementById('board');

  const statusEl=document.getElementById('status');

  const scoreEl=document.getElementById('score');

  const resetBtn=document.getElementById('resetBtn');

  const xColorSel=document.getElementById('xColor');

  const oColorSel=document.getElementById('oColor');

  let board=Array(9).fill(null);

  let placements={X:[],O:[]};

  let turn=X,gameOver=false,nextFirst=X;

  let score=JSON.parse(localStorage.getItem('score')||'{"X":0,"O":0}');



  function makeCell(i){

    const btn=document.createElement('button');

    btn.className='cell';

    btn.dataset.index=i;

    btn.addEventListener('click',()=>tryPlace(i));

    return btn;

  }

  function renderBoard(){

    boardEl.innerHTML='';

    for(let i=0;i<9;i++)boardEl.appendChild(makeCell(i));

    paint();

  }

  function paint(){

    [...boardEl.children].forEach((cell,i)=>{

      cell.textContent=board[i]||'';

      cell.className='cell';

      if(board[i])cell.classList.add(board[i]);

      cell.disabled=gameOver||board[i];

    });

    // show which will be removed next

    ['X','O'].forEach(p=>{

      if(placements[p].length===3){

        const idx=placements[p][0];

        boardEl.children[idx].classList.add('remove-next');

      }

    });

  }

   function tryPlace(i){
    if(gameOver||board[i])return;

    // 1) place the piece and record it
    board[i]=turn;
    placements[turn].push(i);

    // 2) paint immediately to show the new piece
    paint();

    // 3) check for win BEFORE doing any removal of the oldest piece
    const combo=checkWin(turn);
    if(combo){
      highlight(combo);
      gameOver=true;
      score[turn]++;
      updateScore();
      return; // stop here â€” no removal, no further actions
    }

    // 4) only if there's no win do we enforce the "max 3 pieces" rule
    if(placements[turn].length>3){
      const oldest=placements[turn].shift();
      const cell=boardEl.children[oldest];
      // visual fade
      cell.classList.add('fade-out');
      // after fade, clear the board slot and repaint
      setTimeout(()=>{ board[oldest]=null; paint(); },500);
    }

    // 5) continue play
    turn=(turn===X?O:X);
    statusEl.textContent=`Turn: ${turn}`;
  }

  function checkWin(p){

    return winLines.find(([a,b,c])=>board[a]===p&&board[b]===p&&board[c]===p);

  }

  function highlight(c){c.forEach(i=>boardEl.children[i].classList.add('win'));statusEl.textContent=`${turn} wins! ðŸŽ‰`;}

  function updateScore(){scoreEl.textContent=`X: ${score.X} â€“ O: ${score.O}`;localStorage.setItem('score',JSON.stringify(score));}

  function reset(){

    board.fill(null);placements={X:[],O:[]};gameOver=false;

    nextFirst=(nextFirst===X?O:X);turn=nextFirst;

    renderBoard();statusEl.textContent=`Turn: ${turn}`;

  }

  function setTheme(){document.documentElement.style.setProperty('--x-color',xColorSel.value);document.documentElement.style.setProperty('--o-color',oColorSel.value);}
  // Color palettes (distinct and high-contrast options)
const PALETTES = {
  X: [
    {name:'Rose', hex:'#F43F5E'},
    {name:'Tomato', hex:'#EF4444'},
    {name:'OrangeRed', hex:'#F97316'},
    {name:'Crimson', hex:'#DC2626'},
    {name:'Coral', hex:'#F87171'}
  ],
  O: [
    {name:'SkyBlue', hex:'#3B82F6'},
    {name:'Teal', hex:'#14B8A6'},
    {name:'Cyan', hex:'#06B6D4'},
    {name:'Indigo', hex:'#6366F1'},
    {name:'LightBlue', hex:'#60A5FA'}
  ]
};

function buildSwatches() {
  // For both sides (X and O) find the container and hidden input
  document.querySelectorAll('.swatches').forEach(container => {
    const side = container.dataset.side; // "X" or "O"
    const hiddenInput = document.getElementById(side === 'X' ? 'xColor' : 'oColor');
    const palette = PALETTES[side];

    // Clear existing
    container.innerHTML = '';

    palette.forEach((item, idx) => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'swatch';
      btn.style.background = item.hex;
      btn.setAttribute('aria-label', `${side} color ${item.name}`);
      btn.setAttribute('role', 'radio');
      btn.setAttribute('aria-checked', 'false');
      btn.dataset.hex = item.hex;
      btn.dataset.side = side;

      // keyboard support: left/right to move between swatches (optional)
      btn.addEventListener('keydown', (e) => {
        const keys = ['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'];
        if (!keys.includes(e.key)) return;
        e.preventDefault();
        const buttons = Array.from(container.querySelectorAll('.swatch'));
        const i = buttons.indexOf(e.currentTarget);
        let next = i;
        if(e.key === 'ArrowLeft' || e.key === 'ArrowUp') next = (i - 1 + buttons.length) % buttons.length;
        if(e.key === 'ArrowRight' || e.key === 'ArrowDown') next = (i + 1) % buttons.length;
        buttons[next].focus();
      });

      btn.addEventListener('click', (ev) => {
        selectSwatch(ev.currentTarget, hiddenInput, container);
      });

      container.appendChild(btn);
    });

    // Initialize selection from hidden input value or default first
    let startHex = hiddenInput.value || palette[0].hex;
    const firstMatch = container.querySelector(`.swatch[data-hex="${startHex}"]`);
    (firstMatch || container.querySelector('.swatch')).classList.add('selected');
    if(firstMatch) firstMatch.setAttribute('aria-checked', 'true');
    // ensure hidden input matches
    hiddenInput.value = (firstMatch && firstMatch.dataset.hex) || palette[0].hex;
  });

  // After building swatches, call setTheme() so CSS vars update immediately
  if(typeof setTheme === 'function') setTheme();
}

  function selectSwatch(btn, hiddenInput, container) {
    // remove previously selected
    container.querySelectorAll('.swatch').forEach(s => {
      s.classList.remove('selected');
      s.setAttribute('aria-checked', 'false');
    });
    btn.classList.add('selected');
    btn.setAttribute('aria-checked', 'true');
  
    // update hidden input and theme
    hiddenInput.value = btn.dataset.hex;
    if(typeof setTheme === 'function') setTheme();
    // For compatibility with existing listeners that watch change events:
    const changeEvent = new Event('change', { bubbles: true });
    hiddenInput.dispatchEvent(changeEvent);
  }
  
  // Call this once at startup (place after DOM elements exist)
  buildSwatches();

  resetBtn.addEventListener('click',reset);xColorSel.addEventListener('change',setTheme);oColorSel.addEventListener('change',setTheme);

  setTheme();renderBoard();updateScore();

  const resetScoreBtn = document.getElementById('resetScoreBtn');

  resetScoreBtn.addEventListener('click', () => {

  score = { X: 0, O: 0 };

  localStorage.setItem('score', JSON.stringify(score));

  scoreEl.textContent = `X: ${score.X} â€“ O: ${score.O}`;

});



})();

</script>

</body>

</html>
